<script>
  let alarmAktif = false;

  function getSesi(jam) {
    if (jam >= 3 && jam < 5) return "sahur";
    if (jam >= 17 && jam < 19) return "buka";
    return "none";
  }

  function updateJam() {
    const sekarang = new Date();
    const jam = sekarang.getHours();
    const menit = sekarang.getMinutes().toString().padStart(2, '0');
    document.getElementById("jam").innerText = jam + ":" + menit;

    const sesi = getSesi(jam);
    const sesiTersimpan = localStorage.getItem("sesi");

    if (sesi !== sesiTersimpan) {
      localStorage.removeItem("udahMakan");
      localStorage.setItem("sesi", sesi);
      alarmAktif = false;
    }

    let pesan = "Semangat puasanya yaa ðŸ¤";
    let note = "salam hangatt dari cacii ðŸ¤";

    if (sesi === "sahur") {
      pesan = "ðŸŒ™ AYOO SAHUR AFANDII, GABOLEH MALAS ðŸ˜¤";
      note = "awas ga sahur nanti lemes ðŸ¤";
    } 
    else if (sesi === "buka") {
      pesan = "ðŸŒ… WAKTUNYA BUKA PUASA AFANDII ðŸ¤";
      note = "bismillah dulu sebelum makan yaa ðŸ¤";
    }

    // ðŸ”Š AUDIO SAHUR / BUKA (tanpa alarm utama)
    if (
      localStorage.getItem("udahMakan") !== "ya" &&
      sesi !== "none" &&
      !alarmAktif
    ) {
      navigator.vibrate([300, 200, 300]);

      if (sesi === "sahur") {
        document.getElementById("audioSahur").play();
      } 
      else if (sesi === "buka") {
        document.getElementById("audioBuka").play();
      }

      alarmAktif = true;
    }

    if (localStorage.getItem("udahMakan") === "ya") {
      pesan = "ðŸ˜¤ðŸ¤ PINTAR. MAKASIH UDAH MAKAN.";
    }

    document.getElementById("pesan").innerText = pesan;
    document.getElementById("note").innerText = note;
  }

  function udahMakan() {
    localStorage.setItem("udahMakan", "ya");

    const sesi = localStorage.getItem("sesi");
    let pesanWA = "Aku udah makan yaa ðŸ¤";

    if (sesi === "sahur") {
      pesanWA = "Aku udah sahur yaa ðŸ¤";
    } 
    else if (sesi === "buka") {
      pesanWA = "Aku udah buka puasa yaa ðŸ¤";
    }

    const nomorCacii = "6285271960542";
    const linkWA = `https://wa.me/${nomorCacii}?text=${encodeURIComponent(pesanWA)}`;

    window.open(linkWA, "_blank");

    updateJam();
  }

  setInterval(updateJam, 1000);
  updateJam();
</script>
